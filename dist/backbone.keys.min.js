/*!
 * backbone.keys.js v0.2.0 - 2013-03-21
 * Copyright 2012, Raymond Julin (@nervetattoo)
 * backbone.keys.js may be freely distributed under the MIT license.
 */(function(e){return"function"==typeof define&&define.amd?define(["underscore","backbone","jquery"],e):e(_,Backbone,$)})(function(e,n,t){var i,s,r,o;return r=n.View.prototype.delegateEvents,o=n.View.prototype.undelegateEvents,s=function(e){return 1===e.length?e.toUpperCase().charCodeAt(0):i[e]},i={backspace:8,tab:9,enter:13,space:32,shift:16,ctrl:17,alt:18,meta:91,caps_lock:20,esc:27,num_lock:144,page_up:33,page_down:34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,"delete":46,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},e.each({options:"alt","return":"enter"},function(e,n){return i[n]=i[e]}),n.View=n.View.extend({bindKeysOn:"keydown",bindKeysScoped:!1,bindTo:null,_keyEventBindings:null,delegateEvents:function(){return r.apply(this,arguments),this.delegateKeys()},undelegateEvents:function(){return this.undelegateKeys(),o.apply(this,arguments)},delegateKeys:function(n){return this.undelegateKeys(),this.bindTo||(this.bindTo=this.bindKeysScoped||t===void 0?this.$el:t(document)),this.bindTo.on(this.bindKeysOn+".delegateKeys"+this.cid,e.bind(this.triggerKey,this)),n=n||this.keys,n?e.each(n,function(e,n){return this.keyOn(n,e)},this):void 0},undelegateKeys:function(){return this._keyEventBindings={},this.bindTo?this.bindTo.off(this.bindKeysOn+".delegateKeys"+this.cid):void 0},keyName:function(e){var n;n=void 0;for(n in i)if(i[n]===e)return n;return String.fromCharCode(e)},triggerKey:function(n){var t;return t=void 0,e.isObject(n)?t=n.which:e.isString(n)?t=s(n):e.isNumber(n)&&(t=n),e(this._keyEventBindings[t]).each(function(t){var i;return i=!0,t.modifiers&&(i=e(t.modifiers).all(function(e){return n[e+"Key"]===!0})),i?t.method(n,t.key):void 0})},keyOn:function(n,t){var i,r,o;n=n.split(" ");{if(!(n.length>1))return n=n.pop().toLowerCase(),i=n.split("+"),n=i.shift(),r=s(n),this._keyEventBindings.hasOwnProperty(r)||(this._keyEventBindings[r]=[]),e.isFunction(t)||(t=this[t]),this._keyEventBindings[r].push({key:n,modifiers:i||!1,method:e.bind(t,this)}),this;for(o=n.length;o--;)this.keyOn(n[o],t)}},keyOff:function(n,t){var i;return t=t||!1,null===n?(this._keyEventBindings={},this):(i=s(n),e.isFunction(t)||(t=this[t]),t?(this._keyEventBindings[i]=e.filter(this._keyEventBindings[i],function(e){return e.method===t}),this):(this._keyEventBindings[i]=[],this))}}),n});